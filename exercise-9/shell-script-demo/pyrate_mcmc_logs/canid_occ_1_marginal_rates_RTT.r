# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb177/lab-work/exercise-9/shell-script-demo/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb177/lab-work/exercise-9/shell-script-demo/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.187958385344, 0.187958385344,0.187958385344,0.187958385344,0.187958385344,0.0850794256673,0.0382144017905,0.0382144017905,0.0382144017905,0.0382144017905,0.0382144017905,0.0382144017905,0.0382144017905,0.0382144017905,0.0382144017905,0.0382144017905,0.0460708547594,0.0527672819087,0.0907088322377,0.0907088322377,0.0907088322377,0.0907088322377,0.104692274327,0.104692274327,0.104692274327,0.104692274327,0.104692274327,0.104692274327,0.104692274327,0.115973484497,0.115973484497,0.150583930224,0.150583930224,0.150583930224,0.187958385344,0.187958385344,0.187958385344,0.187958385344,0.187958385344,0.187958385344,0.187958385344,0.187958385344,0.133907168912,0.133907168912,0.133907168912,0.133907168912,0.133907168912,0.133907168912,0.133907168912,0.133907168912)
L_hpd_M95=c(0.35843899498, 0.35843899498,0.35843899498,0.35843899498,0.35843899498,0.35843899498,0.294195416385,0.187958385344,0.187958385344,0.187958385344,0.187958385344,0.187958385344,0.187958385344,0.187958385344,0.187958385344,0.187958385344,0.187958385344,0.187958385344,0.187958385344,0.187958385344,0.187958385344,0.187958385344,0.198010609248,0.198010609248,0.232778313025,0.232778313025,0.232778313025,0.232778313025,0.256371188596,0.36406570418,0.397849033284,0.397849033284,0.397849033284,0.538406552719,0.538406552719,0.538406552719,0.538406552719,0.538406552719,0.538406552719,0.538406552719,0.538406552719,0.538406552719,0.538406552719,0.425124577051,0.425124577051,0.425124577051,0.425124577051,0.425124577051,0.425124577051,0.425124577051)
M_hpd_m95=c(0.377350752368, 0.377350752368,0.113661266149,0.113661266149,0.113661266149,0.113661266149,0.113661266149,0.113661266149,0.0995210504221,0.0995210504221,0.0995210504221,0.0995210504221,0.0995210504221,0.0995210504221,0.0995210504221,0.0995210504221,0.0995210504221,0.0995210504221,0.0995210504221,0.0995210504221,0.0995210504221,0.0611291860576,0.0611291860576,0.0611291860576,0.0611291860576,0.0611291860576,0.0611291860576,0.0611291860576,0.0642492917277,0.0642492917277,0.0642492917277,0.0642492917277,0.0642492917277,0.0642492917277,0.0642492917277,0.0642492917277,0.0642492917277,0.0666379786979,0.0770169342747,0.0770169342747,0.0770169342747,0.0770169342747,0.0770169342747,0.0519213481558,0.0519213481558,0.0519213481558,0.0519213481558,0.0519213481558,0.0519213481558,0.0519213481558)
M_hpd_M95=c(1.53448698371, 1.53448698371,0.447112991436,0.447112991436,0.447112991436,0.447112991436,0.387326168337,0.387326168337,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.160385550456,0.224923530531,0.341970285877,0.341970285877,0.341970285877,0.341970285877,0.341970285877,0.341970285877,0.341970285877,0.341970285877,0.341970285877,0.341970285877,0.341970285877,0.341970285877)
R_hpd_m95=c(-1.24029156733, -1.24029156733,-0.193548324145,-0.193548324145,-0.193548324145,-0.151676409094,-0.0991218168596,-0.282633894009,-0.0991218168596,-0.0991218168596,-0.0991218168596,-0.0991218168596,-0.0991218168596,-0.0991218168596,-0.0991218168596,-0.0991218168596,-0.0962701215829,-0.0802446996138,-0.0246214395219,-0.0246214395219,-0.0246214395219,-0.0153286318559,0.00196867306076,0.0051712239053,0.0051712239053,0.0051712239053,0.0051712239053,0.0051712239053,0.0051712239053,0.0232659425533,0.0232659425533,0.0657243900743,0.0657243900743,0.0275728348878,0.152033702835,0.152033702835,0.152033702835,0.0275728348878,-0.0428789911807,-0.0271522811533,-0.0271522811533,-0.0271522811533,-0.0701092702703,-0.0701092702703,-0.0701092702703,-0.0701092702703,-0.208063116965,-0.208063116965,-0.208063116965,-0.208063116965)
R_hpd_M95=c(0.0275728348878, 0.0275728348878,0.233828398697,0.233828398697,0.233828398697,0.278830063455,0.278830063455,0.0275728348878,0.0275728348878,0.0275728348878,0.0275728348878,0.0275728348878,0.0275728348878,0.0275728348878,0.0275728348878,0.0275728348878,0.0275728348878,0.0461095541521,0.0461095541521,0.0461095541521,0.0461095541521,0.107875126313,0.107875126313,0.107875126313,0.159587102286,0.159587102286,0.142092431921,0.142092431921,0.163563416973,0.278830063455,0.299816412452,0.306911032415,0.306911032415,0.372269448682,0.468902203384,0.468902203384,0.468902203384,0.376133084671,0.278830063455,0.278830063455,0.278830063455,0.278830063455,0.278830063455,0.278830063455,0.278830063455,0.278830063455,0.243774956243,0.243774956243,0.243774956243,0.243774956243)
L_mean=c(0.309741588009, 0.309741588009,0.309741588009,0.309741588009,0.309741588009,0.283282521961,0.158764967379,0.121053076362,0.121053076362,0.121053076362,0.121053076362,0.121404914272,0.121404914272,0.121404914272,0.121404914272,0.121404914272,0.142279007214,0.171117678093,0.177896862123,0.177896862123,0.177896862123,0.177896862123,0.189871182384,0.189871182384,0.19379095629,0.19379095629,0.19379095629,0.191104369955,0.204168304524,0.250753303984,0.265541729414,0.28686685937,0.28686685937,0.328696858259,0.351473671808,0.351473671808,0.351473671808,0.350973812706,0.355837599205,0.355837599205,0.342923151148,0.342923151148,0.322678725561,0.304789443862,0.305270728848,0.305270728848,0.29434494185,0.29434494185,0.29434494185,0.29434494185)
M_mean=c(0.884591147832, 0.884591147832,0.208371570035,0.208371570035,0.208371570035,0.208371570035,0.166930019332,0.166930019332,0.148942199462,0.148942199462,0.148942199462,0.148942199462,0.148942199462,0.148942199462,0.148942199462,0.148942199462,0.148942199462,0.148942199462,0.148942199462,0.148942199462,0.148942199462,0.119168352746,0.114880172638,0.111331599169,0.111331599169,0.107559017634,0.108251294007,0.109694518865,0.110702951303,0.109296444044,0.109296444044,0.109296444044,0.109296444044,0.109296444044,0.109296444044,0.108955569165,0.108955569165,0.124136893443,0.206111763082,0.220566941324,0.220566941324,0.220566941324,0.220566941324,0.218603984507,0.218603984507,0.218603984507,0.218603984507,0.218603984507,0.218603984507,0.218603984507)
R_mean=c(-0.574849559822, -0.574849559822,0.101370017974,0.101370017974,0.101370017974,0.0749109519262,-0.00816505195329,-0.0458769429704,-0.0278891231007,-0.0278891231007,-0.0278891231007,-0.0275372851901,-0.0275372851901,-0.0275372851901,-0.0275372851901,-0.0275372851901,-0.00666319224827,0.0221754786302,0.028954662661,0.028954662661,0.028954662661,0.0587285093774,0.074991009746,0.0785395832157,0.0824593571215,0.0862319386562,0.0855396622834,0.0814098510895,0.0934653532215,0.14145685994,0.156245285371,0.177570415326,0.177570415326,0.219400414215,0.242177227764,0.242518102643,0.242518102643,0.226836919262,0.149725836123,0.135270657881,0.122356209824,0.122356209824,0.102111784237,0.0861854593547,0.086666744341,0.086666744341,0.0757409573432,0.0757409573432,0.0757409573432,0.0757409573432)
trans=0.5
age=(0:(50-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.592247207991), xlim = c(-52.5,2.5), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.68793568208), xlim = c(-52.5,2.5), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.36432072406, 0.515792423723), xlim = c(-52.5,2.5), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-52.5,2.5), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()