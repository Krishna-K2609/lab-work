# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.148826094607, 0.148826094607,0.148826094607,0.146021600852,0.141903030647,0.0913061429877,0.050792651366,0.0332462663096,0.0350885842859,0.039728874508,0.0367286659337,0.0375892442001,0.0375892442001,0.0398648956069,0.040000114731,0.0625593225916,0.0719834462425,0.0735490682088,0.0764303069055,0.0772484257435,0.0866841224524,0.093862050606,0.0940343143418,0.0935840706648,0.094192346409,0.0958874676719,0.0957890525652,0.0959361030436,0.0953856391747,0.0949089456607,0.0935840706648,0.10039410418,0.128171962997,0.128241908432,0.13012367974,0.138344233369,0.138344233369,0.138344233369,0.136858514192,0.136858514192,0.136858514192,0.136519465764,0.136858514192,0.134605281927,0.13416119089,0.128241908432,0.122581500038,0.119898368296,0.11362071835,0.102739468404,0.0999057717767,0.0999057717767,0.0999057717767)
L_hpd_M95=c(0.334684323083, 0.334684323083,0.334684323083,0.333739521385,0.333787209229,0.325026854923,0.295608032408,0.166286212892,0.147627004885,0.147627004885,0.143229498381,0.143864671743,0.143864671743,0.146774212183,0.152072627942,0.171314035978,0.170811912219,0.170811912219,0.173699368044,0.174851618395,0.189517776124,0.191301117824,0.191611423475,0.193572225609,0.19487510639,0.197338792779,0.197702314641,0.198596900389,0.1990880971,0.205353113346,0.295754054099,0.384382569992,0.416425222823,0.416117509552,0.416425222823,0.421442174622,0.417420729961,0.416425222823,0.416425222823,0.417420729961,0.418010651215,0.417420729961,0.417420729961,0.417420729961,0.418010651215,0.416425222823,0.417420729961,0.416425222823,0.417236857619,0.417420729961,0.417420729961,0.417420729961,0.417420729961)
M_hpd_m95=c(0.84291240873, 0.84291240873,0.0925087936075,0.0925087936075,0.0933262715462,0.0932443798018,0.0933262715462,0.0935486311506,0.0937801217319,0.0932443798018,0.0943826885737,0.0943826885737,0.0937801217319,0.0947972844298,0.0924822572096,0.0924822572096,0.0910382395467,0.0909476733566,0.0909476733566,0.0909476733566,0.0905556353404,0.0905258583703,0.0892502936074,0.0804717830255,0.0698367701066,0.0517703154346,0.0428410999974,0.0436022128856,0.0422945087511,0.0425527467756,0.0424615556623,0.0393170373533,0.0393170373533,0.0411376838702,0.040636385146,0.0402496229334,0.040105191282,0.0392267931251,0.0382507861951,0.0381727052628,0.0378044315568,0.0350374220866,0.0350374220866,0.031498039454,0.0327506674564,0.0311575651584,0.031498039454,0.031498039454,0.0305880829466,0.0305880829466,0.0305880829466,0.0305880829466,0.0305880829466)
M_hpd_M95=c(1.46414861355, 1.46414861355,0.152999291438,0.152999291438,0.153879496971,0.152999291438,0.15209608803,0.151202478022,0.150501211358,0.149058556681,0.149181984918,0.148879103216,0.147214772922,0.147201015673,0.144161039316,0.143922792789,0.143664683085,0.144550553793,0.144550553793,0.144654914279,0.144355888367,0.144866931469,0.147201015673,0.147201015673,0.147057167342,0.13917933117,0.130775648528,0.130109849395,0.12775731508,0.127544666156,0.127496865514,0.124131518139,0.124145312079,0.12689760157,0.127075175531,0.127544666156,0.127544666156,0.126947673852,0.127544666156,0.129460692359,0.130775648528,0.130059984483,0.130775648528,0.130775648528,0.135718983629,0.135718983629,0.137858527075,0.138072684852,0.138072684852,0.138072684852,0.138072684852,0.138072684852,0.138072684852)
R_hpd_m95=c(-1.25321755167, -1.25321755167,0.0324654389867,0.0353514416012,0.0286967393644,-0.0356937910738,-0.0779356748332,-0.100908431849,-0.093084130309,-0.0876113220783,-0.0860458051747,-0.085786420752,-0.0862755538397,-0.085786420752,-0.0821139338715,-0.0632990375196,-0.0497065628632,-0.0473664856409,-0.0478861437795,-0.044234511551,-0.0377944820419,-0.0340017475008,-0.0335056551462,-0.0313548693406,-0.0340145228848,-0.0272314134231,-0.0149645027618,-0.0124379156244,-0.0129417408933,-0.0116394491381,-0.0123438644094,-0.00366285593765,0.0215204539967,0.0224567281953,0.0408700065688,0.0408700065688,0.0383913366936,0.039330379066,0.0344246250483,0.0235462011557,0.0254683723082,0.0233175349507,0.0233175349507,0.0233175349507,0.0160483108878,0.00570763121018,-0.000567174161616,-0.00804961516359,0.000758691872124,-0.00804961516359,-0.00997235891801,-0.00804961516359,-0.00804961516359)
R_hpd_M95=c(-0.620455826826, -0.620455826826,0.220940063266,0.225374915802,0.225374915802,0.20968905411,0.180914879134,0.0557700829136,0.0367029830961,0.0367029830961,0.0362271620793,0.0355037221003,0.0345988209566,0.0346389939652,0.0411923029868,0.0566937151877,0.0622609609445,0.0625319231483,0.0629241304743,0.0672055482984,0.0767785537365,0.0799120488024,0.0812368462527,0.0875740081971,0.0940449976359,0.11428881288,0.131191679603,0.131191679603,0.13198380179,0.14176527217,0.229536893634,0.308101252997,0.333177014265,0.336570854022,0.353151131095,0.351391607745,0.345566676914,0.345566676914,0.344804656848,0.336570854022,0.341307386468,0.337951905962,0.340058676475,0.343798919964,0.344068207629,0.344068207629,0.348064502957,0.3416633464,0.357482406354,0.357482406354,0.357482406354,0.358354126634,0.358354126634)
L_mean=c(0.25222728203, 0.25222728203,0.252623173068,0.252872933355,0.251511696548,0.236089013956,0.169633809602,0.0991973950851,0.0948295152922,0.0935730080092,0.0932385046054,0.0932062870252,0.0932630101951,0.0934467475127,0.0983916022564,0.11438775795,0.121856544181,0.124657831188,0.125780531327,0.128155801366,0.134443909627,0.138648663719,0.140147210605,0.141499682694,0.141797862968,0.142019592512,0.141912681608,0.142067012642,0.142462503333,0.144536692978,0.163196705908,0.238740792217,0.274541368248,0.281341823684,0.286526029153,0.28614443697,0.284256844859,0.283672695048,0.282128572096,0.280009604471,0.278835630429,0.277040828065,0.276321921452,0.276078574271,0.275810599748,0.276091082584,0.277505695393,0.27682453103,0.277183650504,0.276247258674,0.275936320391,0.275909460978,0.275909460978)
M_mean=c(1.17281597758, 1.17281597758,0.122441932022,0.122437600258,0.122460211042,0.122396124728,0.122128888122,0.121789355198,0.121467868933,0.121268374738,0.120955302157,0.120764142377,0.12031434494,0.119181141949,0.118349635438,0.117727230168,0.117270968188,0.116841229011,0.116782709837,0.116766159636,0.116755521183,0.116583765735,0.11566165378,0.114108976779,0.111016309591,0.103620091489,0.0933460862083,0.0905996711847,0.0874067628423,0.0856422612132,0.0848322749133,0.0843856715316,0.0842155838363,0.0842857946183,0.0834524551435,0.082946347839,0.0829354321318,0.0831683934349,0.0834404531298,0.0839790292867,0.0843489226154,0.0852409386936,0.0861425481563,0.0873590059379,0.0888040745713,0.0897303602045,0.0902346426942,0.0902683039919,0.0905030565246,0.0905030565246,0.0905030565246,0.0905030565246,0.0905030565246)
R_mean=c(-0.920588695553, -0.920588695553,0.130181241046,0.130435333097,0.129051485506,0.113692889228,0.0475049214805,-0.0225919601127,-0.0266383536405,-0.0276953667292,-0.0277167975517,-0.0275578553516,-0.0270513347453,-0.0257343944367,-0.0199580331817,-0.00333947221794,0.00458557599259,0.00781660217786,0.00899782148936,0.01138964173,0.0176883884442,0.0220648979842,0.0244855568252,0.0273907059155,0.0307815533769,0.0383995010232,0.0485665953999,0.0514673414572,0.0550557404908,0.0588944317644,0.078364430995,0.154355120685,0.190325784412,0.197056029066,0.203073574009,0.203198089131,0.201321412727,0.200504301613,0.198688118966,0.196030575184,0.194486707814,0.191799889372,0.190179373295,0.188719568333,0.187006525177,0.186360722379,0.187271052699,0.186556227038,0.186680593979,0.185744202149,0.185433263867,0.185406404454,0.185406404454)
trans=0.5
age=(0:(53-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.463586392085), xlim = c(-55.65,2.65), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.6105634749), xlim = c(-55.65,2.65), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.37853930684, 0.394189539297), xlim = c(-55.65,2.65), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-55.65,2.65), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()